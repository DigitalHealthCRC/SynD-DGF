<!-- Mobile-Optimized Navigation Menu -->
<nav class="mobile-navigation" role="navigation" aria-label="Mobile site navigation">
  <div class="mobile-nav-header">
    <button class="mobile-nav-toggle" aria-expanded="false" aria-controls="mobile-nav-menu">
      <span class="nav-toggle-icon">☰</span>
      <span class="nav-toggle-text">Menu</span>
    </button>
  </div>

  <div class="mobile-nav-menu" id="mobile-nav-menu" aria-hidden="true">
    <div class="mobile-nav-content">
      
      <!-- Quick Access -->
      <div class="nav-section quick-access">
        <h3>Quick Access</h3>
        <div class="quick-links">
          <a href="/" class="quick-link">
            <span class="quick-icon">🏠</span>
            <span class="quick-text">Home</span>
          </a>
          <a href="/web-pages/framework-overview/FrameworkOverview.en-US.webpage.copy.html" class="quick-link">
            <span class="quick-icon">📋</span>
            <span class="quick-text">Framework</span>
          </a>
          <a href="/decision-support-overview" class="quick-link">
            <span class="quick-icon">🛠️</span>
            <span class="quick-text">Tools</span>
          </a>
          <a href="/resources" class="quick-link">
            <span class="quick-icon">📚</span>
            <span class="quick-text">Resources</span>
          </a>
        </div>
      </div>

      <!-- Framework Section -->
      <div class="nav-section framework-section">
        <button class="section-toggle" aria-expanded="false" data-target="framework-menu">
          <span class="section-icon">📋</span>
          <span class="section-title">Framework Process</span>
          <span class="toggle-indicator">▼</span>
        </button>
        
        <div class="section-menu" id="framework-menu">
          <a href="/web-pages/framework-overview/FrameworkOverview.en-US.webpage.copy.html" class="menu-item overview-item">
            <span class="item-icon">🎯</span>
            <span class="item-text">Framework Overview</span>
          </a>
          
          <div class="step-items">
            <a href="/web-pages/step-1-use-case-assessment/Step1UseCaseAssessment.en-US.webpage.copy.html" class="menu-item step-item">
              <span class="item-icon step-number">1</span>
              <span class="item-text">Assess Use Case</span>
            </a>
            <a href="/web-pages/step-2-assess-source-data/Step2AssessSourceData.en-US.webpage.copy.html" class="menu-item step-item">
              <span class="item-icon step-number">2</span>
              <span class="item-text">Assess Source Data</span>
            </a>
            <a href="/web-pages/step-3-generate-synthetic-data/Step3GenerateSyntheticData.en-US.webpage.copy.html" class="menu-item step-item">
              <span class="item-icon step-number">3</span>
              <span class="item-text">Generate Data</span>
            </a>
            <a href="/web-pages/step-4-assess-reidentification-risks/Step4AssessReidentificationRisks.en-US.webpage.copy.html" class="menu-item step-item">
              <span class="item-icon step-number">4</span>
              <span class="item-text">Risk Assessment</span>
            </a>
            <a href="/web-pages/step-5-manage-residual-risks/Step5ManageResidualRisks.en-US.webpage.copy.html" class="menu-item step-item">
              <span class="item-icon step-number">5</span>
              <span class="item-text">Risk Management</span>
            </a>
          </div>
        </div>
      </div>

      <!-- Decision Support Section -->
      <div class="nav-section decision-support-section">
        <button class="section-toggle" aria-expanded="false" data-target="decision-support-menu">
          <span class="section-icon">🛠️</span>
          <span class="section-title">Decision Support</span>
          <span class="toggle-indicator">▼</span>
        </button>
        
        <div class="section-menu" id="decision-support-menu">
          <a href="/decision-support-overview" class="menu-item overview-item">
            <span class="item-icon">🎯</span>
            <span class="item-text">Overview</span>
          </a>
          <a href="/complex-scenarios-navigator" class="menu-item">
            <span class="item-icon">🧭</span>
            <span class="item-text">Scenarios Navigator</span>
          </a>
          <a href="/legal-pathways-wizard" class="menu-item">
            <span class="item-icon">⚖️</span>
            <span class="item-text">Legal Pathways</span>
          </a>
          <a href="/risk-mitigation-planner" class="menu-item">
            <span class="item-icon">🛡️</span>
            <span class="item-text">Risk Mitigation</span>
          </a>
          <a href="/jurisdiction-mapper" class="menu-item">
            <span class="item-icon">🗺️</span>
            <span class="item-text">Jurisdiction Mapper</span>
          </a>
        </div>
      </div>

      <!-- Assessment Tools Section -->
      <div class="nav-section assessment-section">
        <button class="section-toggle" aria-expanded="false" data-target="assessment-menu">
          <span class="section-icon">📋</span>
          <span class="section-title">Assessment Tools</span>
          <span class="toggle-indicator">▼</span>
        </button>
        
        <div class="section-menu" id="assessment-menu">
          <a href="/assessment-tools" class="menu-item overview-item">
            <span class="item-icon">🎯</span>
            <span class="item-text">Overview</span>
          </a>
          <a href="/use-case-assessment-tool" class="menu-item">
            <span class="item-icon">✅</span>
            <span class="item-text">Use Case Assessment</span>
          </a>
          <a href="/risk-evaluation-tool" class="menu-item">
            <span class="item-icon">⚠️</span>
            <span class="item-text">Risk Evaluation</span>
          </a>
          <a href="/compliance-checklist-tool" class="menu-item">
            <span class="item-icon">📝</span>
            <span class="item-text">Compliance Checklist</span>
          </a>
          <a href="/quality-metrics-tool" class="menu-item">
            <span class="item-icon">📊</span>
            <span class="item-text">Quality Metrics</span>
          </a>
        </div>
      </div>

      <!-- Resources Section -->
      <div class="nav-section resources-section">
        <button class="section-toggle" aria-expanded="false" data-target="resources-menu">
          <span class="section-icon">📚</span>
          <span class="section-title">Resources</span>
          <span class="toggle-indicator">▼</span>
        </button>
        
        <div class="section-menu" id="resources-menu">
          <a href="/resources" class="menu-item overview-item">
            <span class="item-icon">🎯</span>
            <span class="item-text">All Resources</span>
          </a>
          <a href="/resources/framework-documentation" class="menu-item">
            <span class="item-icon">📄</span>
            <span class="item-text">Documentation</span>
          </a>
          <a href="/resources/implementation-guides" class="menu-item">
            <span class="item-icon">🗺️</span>
            <span class="item-text">Implementation</span>
          </a>
          <a href="/resources/policy-templates" class="menu-item">
            <span class="item-icon">📋</span>
            <span class="item-text">Policy Templates</span>
          </a>
          <a href="/resources/training-materials" class="menu-item">
            <span class="item-icon">🎓</span>
            <span class="item-text">Training</span>
          </a>
          
          <!-- Appendices submenu -->
          <div class="submenu-section">
            <button class="submenu-toggle" aria-expanded="false" data-target="appendices-submenu">
              <span class="submenu-title">Framework Appendices</span>
              <span class="toggle-indicator">▼</span>
            </button>
            <div class="submenu" id="appendices-submenu">
              <a href="/resources/appendices/glossary" class="submenu-item">
                <span class="appendix-number">1</span>
                <span class="appendix-title">Glossary</span>
              </a>
              <a href="/resources/appendices/legal-analysis" class="submenu-item">
                <span class="appendix-number">2</span>
                <span class="appendix-title">Legal Analysis</span>
              </a>
              <a href="/resources/appendices/international-approaches" class="submenu-item">
                <span class="appendix-number">3</span>
                <span class="appendix-title">International</span>
              </a>
              <a href="/resources/appendices/use-case-criteria" class="submenu-item">
                <span class="appendix-number">4</span>
                <span class="appendix-title">Use Case Criteria</span>
              </a>
              <a href="/resources/appendices/data-characteristics" class="submenu-item">
                <span class="appendix-number">5</span>
                <span class="appendix-title">Data Characteristics</span>
              </a>
              <a href="/resources/appendices/technical-assessment" class="submenu-item">
                <span class="appendix-number">6</span>
                <span class="appendix-title">Technical Assessment</span>
              </a>
              <a href="/resources/appendices/deidentification" class="submenu-item">
                <span class="appendix-number">7</span>
                <span class="appendix-title">De-identification</span>
              </a>
              <a href="/resources/appendices/complex-scenarios" class="submenu-item">
                <span class="appendix-number">8</span>
                <span class="appendix-title">Complex Scenarios</span>
              </a>
              <a href="/resources/appendices/legal-pathways" class="submenu-item">
                <span class="appendix-number">9</span>
                <span class="appendix-title">Legal Pathways</span>
              </a>
              <a href="/resources/appendices/five-safes" class="submenu-item">
                <span class="appendix-number">10</span>
                <span class="appendix-title">Five Safes</span>
              </a>
              <a href="/resources/appendices/risk-assessment" class="submenu-item">
                <span class="appendix-number">11</span>
                <span class="appendix-title">Risk Assessment</span>
              </a>
              <a href="/resources/appendices/stakeholder-engagement" class="submenu-item">
                <span class="appendix-number">12</span>
                <span class="appendix-title">Stakeholder</span>
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- About Section -->
      <div class="nav-section about-section">
        <button class="section-toggle" aria-expanded="false" data-target="about-menu">
          <span class="section-icon">ℹ️</span>
          <span class="section-title">About</span>
          <span class="toggle-indicator">▼</span>
        </button>
        
        <div class="section-menu" id="about-menu">
          <a href="/about-framework" class="menu-item">
            <span class="item-icon">📖</span>
            <span class="item-text">About Framework</span>
          </a>
          <a href="/methodology" class="menu-item">
            <span class="item-icon">🔬</span>
            <span class="item-text">Methodology</span>
          </a>
          <a href="/stakeholder-consultation" class="menu-item">
            <span class="item-icon">👥</span>
            <span class="item-text">Consultation</span>
          </a>
          <a href="/contact" class="menu-item">
            <span class="item-icon">📧</span>
            <span class="item-text">Contact</span>
          </a>
        </div>
      </div>

    </div>
  </div>

  <!-- Overlay -->
  <div class="mobile-nav-overlay" aria-hidden="true"></div>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const mobileNav = document.querySelector('.mobile-navigation');
    const navToggle = document.querySelector('.mobile-nav-toggle');
    const navMenu = document.querySelector('.mobile-nav-menu');
    const navOverlay = document.querySelector('.mobile-nav-overlay');
    const sectionToggles = document.querySelectorAll('.section-toggle');
    const submenuToggles = document.querySelectorAll('.submenu-toggle');

    // Main menu toggle
    navToggle.addEventListener('click', function() {
        const isExpanded = navToggle.getAttribute('aria-expanded') === 'true';
        
        navToggle.setAttribute('aria-expanded', !isExpanded);
        navMenu.setAttribute('aria-hidden', isExpanded);
        navOverlay.setAttribute('aria-hidden', isExpanded);
        
        mobileNav.classList.toggle('nav-open', !isExpanded);
        document.body.classList.toggle('nav-open', !isExpanded);
        
        // Update toggle icon
        const toggleIcon = navToggle.querySelector('.nav-toggle-icon');
        toggleIcon.textContent = !isExpanded ? '✕' : '☰';
    });

    // Close menu when overlay is clicked
    navOverlay.addEventListener('click', function() {
        closeMenu();
    });

    // Section toggles
    sectionToggles.forEach(toggle => {
        toggle.addEventListener('click', function() {
            const targetId = this.getAttribute('data-target');
            const targetMenu = document.getElementById(targetId);
            const isExpanded = this.getAttribute('aria-expanded') === 'true';
            
            // Close other sections
            sectionToggles.forEach(otherToggle => {
                if (otherToggle !== this) {
                    otherToggle.setAttribute('aria-expanded', 'false');
                    const otherTargetId = otherToggle.getAttribute('data-target');
                    const otherMenu = document.getElementById(otherTargetId);
                    if (otherMenu) {
                        otherMenu.classList.remove('menu-open');
                        otherToggle.querySelector('.toggle-indicator').textContent = '▼';
                    }
                }
            });
            
            // Toggle current section
            this.setAttribute('aria-expanded', !isExpanded);
            targetMenu.classList.toggle('menu-open', !isExpanded);
            
            // Update indicator
            const indicator = this.querySelector('.toggle-indicator');
            indicator.textContent = !isExpanded ? '▲' : '▼';
        });
    });

    // Submenu toggles
    submenuToggles.forEach(toggle => {
        toggle.addEventListener('click', function() {
            const targetId = this.getAttribute('data-target');
            const targetSubmenu = document.getElementById(targetId);
            const isExpanded = this.getAttribute('aria-expanded') === 'true';
            
            this.setAttribute('aria-expanded', !isExpanded);
            targetSubmenu.classList.toggle('submenu-open', !isExpanded);
            
            // Update indicator
            const indicator = this.querySelector('.toggle-indicator');
            indicator.textContent = !isExpanded ? '▲' : '▼';
        });
    });

    // Close menu on link click
    const menuLinks = document.querySelectorAll('.menu-item, .submenu-item');
    menuLinks.forEach(link => {
        link.addEventListener('click', function() {
            closeMenu();
        });
    });

    function closeMenu() {
        navToggle.setAttribute('aria-expanded', 'false');
        navMenu.setAttribute('aria-hidden', 'true');
        navOverlay.setAttribute('aria-hidden', 'true');
        mobileNav.classList.remove('nav-open');
        document.body.classList.remove('nav-open');
        
        const toggleIcon = navToggle.querySelector('.nav-toggle-icon');
        toggleIcon.textContent = '☰';
    }

    // Close menu on escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && mobileNav.classList.contains('nav-open')) {
            closeMenu();
        }
    });
});
</script>

<style>
.mobile-navigation {
  position: relative;
  z-index: 1000;
}

.mobile-nav-header {
  display: flex;
  align-items: center;
  padding: 1rem;
  background: #f8f9fa;
  border-bottom: 1px solid #e0e0e0;
}

.mobile-nav-toggle {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  background: none;
  border: 1px solid #007bff;
  border-radius: 6px;
  padding: 0.75rem 1rem;
  color: #007bff;
  cursor: pointer;
  transition: all 0.3s ease;
}

.mobile-nav-toggle:hover {
  background: #007bff;
  color: white;
}

.mobile-nav-toggle:focus {
  outline: 2px solid #007bff;
  outline-offset: 2px;
}

.nav-toggle-icon {
  font-size: 1.2rem;
  font-weight: bold;
}

.nav-toggle-text {
  font-weight: 500;
}

.mobile-nav-menu {
  position: fixed;
  top: 0;
  left: -100%;
  width: 90%;
  max-width: 400px;
  height: 100vh;
  background: white;
  border-right: 1px solid #e0e0e0;
  transition: left 0.3s ease;
  overflow-y: auto;
  z-index: 1001;
}

.mobile-navigation.nav-open .mobile-nav-menu {
  left: 0;
}

.mobile-nav-content {
  padding: 1rem;
}

.mobile-nav-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0,0,0,0.5);
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  z-index: 1000;
}

.mobile-navigation.nav-open .mobile-nav-overlay {
  opacity: 1;
  visibility: visible;
}

body.nav-open {
  overflow: hidden;
}

.nav-section {
  margin-bottom: 1rem;
}

.quick-access {
  background: #f8f9fa;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 2rem;
}

.quick-access h3 {
  color: #495057;
  margin-bottom: 1rem;
  font-size: 1rem;
  font-weight: 600;
}

.quick-links {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.5rem;
}

.quick-link {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  padding: 1rem;
  background: white;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  color: #495057;
  text-decoration: none;
  transition: all 0.3s ease;
  text-align: center;
}

.quick-link:hover {
  background: #e9ecef;
  color: #007bff;
  text-decoration: none;
  transform: translateY(-2px);
}

.quick-icon {
  font-size: 1.5rem;
}

.quick-text {
  font-size: 0.9rem;
  font-weight: 500;
}

.section-toggle {
  width: 100%;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 1rem;
  background: #f8f9fa;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  color: #495057;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 1rem;
  font-weight: 500;
}

.section-toggle:hover {
  background: #e9ecef;
  border-color: #007bff;
}

.section-toggle:focus {
  outline: 2px solid #007bff;
  outline-offset: 2px;
}

.section-icon {
  font-size: 1.2rem;
}

.section-title {
  flex-grow: 1;
  text-align: left;
}

.toggle-indicator {
  font-size: 0.9rem;
  transition: transform 0.3s ease;
}

.section-menu {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
  margin-top: 0.5rem;
}

.section-menu.menu-open {
  max-height: 1000px;
}

.menu-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.75rem 1rem;
  color: #495057;
  text-decoration: none;
  border-radius: 4px;
  transition: all 0.3s ease;
  margin: 0.25rem 0;
  font-size: 0.95rem;
}

.menu-item:hover {
  background: #f8f9fa;
  color: #007bff;
  text-decoration: none;
  transform: translateX(3px);
}

.menu-item:focus {
  outline: 2px solid #007bff;
  outline-offset: 2px;
}

.item-icon {
  width: 28px;
  height: 28px;
  background: #e9ecef;
  color: #495057;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.9rem;
  flex-shrink: 0;
}

.step-number {
  background: #28a745;
  color: white;
  font-weight: bold;
}

.overview-item .item-icon {
  background: #007bff;
  color: white;
}

.item-text {
  font-weight: 500;
}

.step-items {
  display: grid;
  gap: 0.25rem;
  margin: 0.5rem 0;
}

.submenu-section {
  margin: 0.5rem 0;
}

.submenu-toggle {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 1rem;
  background: #e9ecef;
  border: 1px solid #dee2e6;
  border-radius: 4px;
  color: #495057;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 0.9rem;
  font-weight: 500;
}

.submenu-toggle:hover {
  background: #dee2e6;
}

.submenu {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
  margin-top: 0.25rem;
}

.submenu.submenu-open {
  max-height: 800px;
}

.submenu-item {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.5rem 1rem;
  color: #6c757d;
  text-decoration: none;
  border-radius: 4px;
  transition: all 0.3s ease;
  margin: 0.1rem 0;
  font-size: 0.85rem;
}

.submenu-item:hover {
  background: #f8f9fa;
  color: #007bff;
  text-decoration: none;
}

.appendix-number {
  width: 20px;
  height: 20px;
  background: #6c757d;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.7rem;
  font-weight: bold;
  flex-shrink: 0;
}

.appendix-title {
  font-weight: 500;
}

/* Hide on larger screens */
@media (min-width: 769px) {
  .mobile-navigation {
    display: none;
  }
}

/* Very small screens */
@media (max-width: 360px) {
  .mobile-nav-menu {
    width: 95%;
  }
  
  .quick-links {
    grid-template-columns: 1fr;
  }
  
  .quick-link {
    padding: 0.75rem;
  }
}
</style>