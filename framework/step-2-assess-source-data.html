<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- SynD-DGF Unified Design System - Forest Canopy Theme -->
<link rel="stylesheet" href="../assets/css/synd-design-system.css">
<link rel="stylesheet" href="../assets/css/synd-additional-components.css">

<!-- Lucide Icons -->
<script src="https://unpkg.com/lucide@latest"></script>

</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark" >
        <div class="container">
            <a class="navbar-brand" href="../index.html">SynD-DGF</a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="../index.html">Home</a>
                <a class="nav-link" href="../framework.html">Framework</a>
                <a class="nav-link" href="../assessment-tools.html">Assessment Tools</a>
                <a class="nav-link" href="../resources.html">Resources</a>
            </div>
        </div>
    </nav>

    <!-- Enhanced Breadcrumbs with Framework Context -->
<nav class="enhanced-breadcrumbs" aria-label="Breadcrumb navigation">
  <div class="breadcrumb-container">

    <!-- Framework Step Context -->
    <div class="framework-context" id="framework-context" style="display: none;">
      <div class="context-header">
        <span class="context-icon">üìã</span>
        <span class="context-title">Framework Step</span>
      </div>
      <div class="step-progress">
        <div class="step-indicator" data-step="1">
          <span class="step-number">1</span>
          <span class="step-name">Use Case</span>
        </div>
        <div class="step-indicator" data-step="2">
          <span class="step-number">2</span>
          <span class="step-name">Source Data</span>
        </div>
        <div class="step-indicator" data-step="3">
          <span class="step-number">3</span>
          <span class="step-name">Generate Data</span>
        </div>
        <div class="step-indicator" data-step="4">
          <span class="step-number">4</span>
          <span class="step-name">Risk Assessment</span>
        </div>
        <div class="step-indicator" data-step="5">
          <span class="step-number">5</span>
          <span class="step-name">Risk Management</span>
        </div>
      </div>
    </div>

    <!-- Standard Breadcrumbs -->
    <ol class="breadcrumb-list">
      <li class="breadcrumb-item">
        <a href="/" class="breadcrumb-link">
          <span class="breadcrumb-icon">üè†</span>
          <span class="breadcrumb-text">Home</span>
        </a>
      </li>

      <!-- Dynamic breadcrumbs will be inserted here by JavaScript -->
      <li class="breadcrumb-item current" id="current-page">
        <span class="breadcrumb-text">Step 2: Assess Source Data</span>
      </li>
    </ol>

    <!-- Page Actions -->
    <div class="page-actions">
      <button class="action-button" onclick="printPage()" title="Print this page">
        <span class="action-icon">üñ®Ô∏è</span>
      </button>
      <button class="action-button" onclick="sharePage()" title="Share this page">
        <span class="action-icon">üì§</span>
      </button>
      <button class="action-button" onclick="bookmarkPage()" title="Bookmark this page">
        <span class="action-icon">üîñ</span>
      </button>
    </div>
  </div>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const currentPath = window.location.pathname;
    const breadcrumbList = document.querySelector('.breadcrumb-list');
    const currentPageItem = document.getElementById('current-page');
    const frameworkContext = document.getElementById('framework-context');

    // Framework step mapping
    const frameworkSteps = {
        '/framework-overview': { section: 'framework', step: 0, title: 'Framework Overview' },
        '/step-1-use-case-assessment': { section: 'framework', step: 1, title: 'Step 1: Assess Use Case' },
        '/step-2-assess-source-data': { section: 'framework', step: 2, title: 'Step 2: Assess Source Data' },
        '/step-3-generate-synthetic-data': { section: 'framework', step: 3, title: 'Step 3: Generate Synthetic Data' },
        '/step-4-assess-reidentification-risks': { section: 'framework', step: 4, title: 'Step 4: Assess Re-identification Risks' },
        '/step-5-manage-residual-risks': { section: 'framework', step: 5, title: 'Step 5: Manage Residual Risks' }
    };

    function buildBreadcrumbs() {
        // For Step 2 page specifically
        const breadcrumbs = [{
            url: '/framework-overview',
            text: 'Framework',
            icon: 'üìã'
        }];

        const stepInfo = frameworkSteps['/step-2-assess-source-data'];
        if (stepInfo) {
            showFrameworkContext(stepInfo.step);
        }

        insertBreadcrumbs(breadcrumbs);
    }

    function insertBreadcrumbs(breadcrumbs) {
        // Remove existing dynamic breadcrumbs
        const existingBreadcrumbs = breadcrumbList.querySelectorAll('.dynamic-breadcrumb');
        existingBreadcrumbs.forEach(item => item.remove());

        // Insert new breadcrumbs before current page
        breadcrumbs.forEach((crumb) => {
            const breadcrumbItem = createBreadcrumbItem(crumb);
            breadcrumbList.insertBefore(breadcrumbItem, currentPageItem);
        });
    }

    function createBreadcrumbItem(crumb) {
        const li = document.createElement('li');
        li.className = 'breadcrumb-item dynamic-breadcrumb';

        const link = document.createElement('a');
        link.href = crumb.url;
        link.className = 'breadcrumb-link';

        const icon = document.createElement('span');
        icon.className = 'breadcrumb-icon';
        icon.textContent = crumb.icon;

        const text = document.createElement('span');
        text.className = 'breadcrumb-text';
        text.textContent = crumb.text;

        link.appendChild(icon);
        link.appendChild(text);
        li.appendChild(link);

        return li;
    }

    function showFrameworkContext(currentStep) {
        frameworkContext.style.display = 'block';

        // Update step indicators
        const stepIndicators = frameworkContext.querySelectorAll('.step-indicator');
        stepIndicators.forEach((indicator, index) => {
            const stepNumber = index + 1;
            indicator.classList.remove('completed', 'current', 'upcoming');

            if (stepNumber < currentStep) {
                indicator.classList.add('completed');
            } else if (stepNumber === currentStep) {
                indicator.classList.add('current');
            } else {
                indicator.classList.add('upcoming');
            }
        });
    }

    // Initialize breadcrumbs
    buildBreadcrumbs();
});

// Page action functions
function printPage() {
    window.print();
}

function sharePage() {
    if (navigator.share) {
        navigator.share({
            title: document.title,
            url: window.location.href
        });
    } else {
        // Fallback: copy URL to clipboard
        navigator.clipboard.writeText(window.location.href).then(() => {
            alert('Page URL copied to clipboard');
        });
    }
}

function bookmarkPage() {
    // Store bookmark in localStorage
    const bookmark = {
        title: document.title,
        url: window.location.href,
        timestamp: new Date().toISOString()
    };

    let bookmarks = JSON.parse(localStorage.getItem('synd-bookmarks') || '[]');
    bookmarks.push(bookmark);
    localStorage.setItem('synd-bookmarks', JSON.stringify(bookmarks));

    alert('Page bookmarked successfully');
}
</script>

    <div class="container">
        <div class="row">
            <div class="col-md-12">

                <h1>Step 2: Assess and prepare source data</h1>
                
                <div class="step-intro">
                    <p class="lead">Ensuring your source data is suitable, available, and properly prepared is critical for generating high-quality synthetic data that maintains utility whilst protecting privacy.</p>
                    <div class="step-objectives">
                        <h2>Step objectives</h2>
                        <ul>
                            <li>Verify data availability and organisational control over source datasets</li>
                            <li>Assess technical quality and fitness for purpose of source data</li>
                            <li>Prepare data by removing or augmenting directly identifying information</li>
                            <li>Create comprehensive data specifications and quality statements</li>
                        </ul>
                    </div>
                </div>

                <div class="assessment-areas content-section-card">
                    <h2>Key assessment areas</h2>

                    <div class="assessment-card" data-component-theme="portalThemeColorBlue">
                        <h3>Data availability and control</h3>
                        <p>Before proceeding, confirm your organisation has appropriate access to and control over the source data:</p>
                        
                        <div class="control-checklist">
                            <h4>Data ownership and control verification</h4>
                            <ul>
                                <li><strong>Direct control:</strong> Your organisation collected and owns the source data</li>
                                <li><strong>Legal access:</strong> You have lawful authority to access and use the data for synthetic data generation</li>
                                <li><strong>Data location:</strong> Source data is held within secure systems under your organisation's control</li>
                                <li><strong>No external dependencies:</strong> Generation doesn't require data from other organisations (unless specifically assessed as a complex scenario)</li>
                            </ul>
                        </div>

                        <div class="complex-scenarios-alert">
                            <h4>‚ö†Ô∏è Complex scenarios requiring additional assessment</h4>
                            <p>If any of the following apply, your project requires additional assessment before proceeding:</p>
                            <ul>
                                <li>Source data is held by multiple organisations requiring data linkage</li>
                                <li>Data enrichment from external sources is needed</li>
                                <li>Third-party data processors or cloud providers will access source data</li>
                                <li>Cross-jurisdictional data sharing arrangements are involved</li>
                            </ul>
                            <p><strong>Action required:</strong> Consult the <a href="#" title="Coming Soon">complex scenarios decision tree</a> for additional guidance.</p>
                        </div>

                        <div class="assessment-action">
                            <a href="../assessment-tools.html" class="btn-modern-primary">Complete Data Availability Assessment</a>
                        </div>
                    </div>

                    <div class="assessment-card" data-component-theme="portalThemeColorGreen">
                        <h3>Technical assessment</h3>
                        <p>Evaluate whether your source data meets technical requirements for synthetic data generation:</p>
                        
                        <div class="technical-criteria">
                            <h4>Data quality requirements</h4>
                            <div class="quality-grid">
                                <div class="quality-item">
                                    <h5>Accuracy</h5>
                                    <p>Data values are correct and reflect real-world conditions accurately</p>
                                    <ul>
                                        <li>Clinical values within expected ranges</li>
                                        <li>Consistent coding and classification systems</li>
                                        <li>Validated against source systems where possible</li>
                                    </ul>
                                </div>
                                <div class="quality-item">
                                    <h5>Completeness</h5>
                                    <p>Sufficient data coverage for meaningful synthetic data generation</p>
                                    <ul>
                                        <li>Acceptable levels of missing data (typically <20% for key variables)</li>
                                        <li>Representative coverage across target populations</li>
                                        <li>Complete records for essential analytical variables</li>
                                    </ul>
                                </div>
                                <div class="quality-item">
                                    <h5>Consistency</h5>
                                    <p>Data follows consistent formats, standards, and business rules</p>
                                    <ul>
                                        <li>Standardised coding systems (ICD-10, SNOMED CT)</li>
                                        <li>Consistent date formats and time zones</li>
                                        <li>Logical relationships between related data elements</li>
                                    </ul>
                                </div>
                                <div class="quality-item">
                                    <h5>Currency</h5>
                                    <p>Data is sufficiently current for the intended use case</p>
                                    <ul>
                                        <li>Recent enough to reflect current healthcare practices</li>
                                        <li>Appropriate temporal coverage for longitudinal analysis</li>
                                        <li>Regular data refresh cycles where applicable</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="fitness-assessment">
                            <h4>Fitness for purpose evaluation</h4>
                            <p>Consider whether your source data supports your intended synthetic data use case:</p>
                            <ul>
                                <li><strong>Statistical properties:</strong> Source data contains the statistical relationships needed for your analysis</li>
                                <li><strong>Sample size:</strong> Sufficient records to generate meaningful synthetic datasets (typically >1,000 records)</li>
                                <li><strong>Variable coverage:</strong> All necessary data elements are present in the source dataset</li>
                                <li><strong>Temporal alignment:</strong> Data collection periods align with your analytical requirements</li>
                                <li><strong>Population coverage:</strong> Source data represents the population of interest for your use case</li>
                            </ul>
                        </div>

                        <div class="assessment-action">
                            <a href="../assessment-tools.html" class="btn-modern-primary">Complete Technical Assessment</a>
                        </div>
                    </div>

                    <div class="assessment-card" data-component-theme="portalThemeColorOrange">
                        <h3>Data preparation and de-identification</h3>
                        <p>Prepare your source data to minimise privacy risks whilst maintaining utility for synthetic data generation:</p>
                        
                        <div class="preparation-steps">
                            <h4>Remove or augment directly identifying information</h4>
                            <p>All fields containing directly identifying information must be addressed before synthetic data generation:</p>
                            
                            <div class="identifier-categories">
                                <div class="identifier-category">
                                    <h5>Direct identifiers (must be removed)</h5>
                                    <ul>
                                        <li>Names (first, middle, last, nicknames)</li>
                                        <li>Addresses (street, postal codes if population <20,000)</li>
                                        <li>Phone numbers and email addresses</li>
                                        <li>Government identifiers (Medicare numbers, driver licence numbers)</li>
                                        <li>Institutional identifiers (patient numbers, employee IDs)</li>
                                        <li>Biometric identifiers</li>
                                        <li>Photos and other images</li>
                                    </ul>
                                </div>
                                
                                <div class="identifier-category">
                                    <h5>Quasi-identifiers (require augmentation)</h5>
                                    <ul>
                                        <li><strong>Dates:</strong> Replace specific dates with age, year, or date ranges</li>
                                        <li><strong>Geographic information:</strong> Use broader geographic regions rather than specific locations</li>
                                        <li><strong>Demographic combinations:</strong> Assess re-identification risk of age/gender/postcode combinations</li>
                                        <li><strong>Rare characteristics:</strong> Generalise or suppress very uncommon conditions or procedures</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="preparation-techniques">
                                <h4>Data preparation techniques</h4>
                                <div class="row">
                                    <div class="col-md-6">
                                        <h5>Generalisation</h5>
                                        <ul>
                                            <li>Replace specific values with broader categories</li>
                                            <li>Use age groups instead of exact ages</li>
                                            <li>Aggregate geographic areas (postcode to region)</li>
                                            <li>Group rare conditions into broader categories</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h5>Suppression</h5>
                                        <ul>
                                            <li>Remove fields not essential for synthetic data generation</li>
                                            <li>Delete records with unique or highly identifying characteristics</li>
                                            <li>Suppress values that occur very infrequently</li>
                                            <li>Remove free-text fields unless essential</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="risk-warning">
                                <h4>‚ö†Ô∏è Important privacy consideration</h4>
                                <p>If directly identifying information cannot be removed or appropriately augmented, organisations must:</p>
                                <ul>
                                    <li>Be aware of increased risk of data leakage through the synthetic dataset</li>
                                    <li>Assess and document heightened re-identification risks</li>
                                    <li>Implement additional safeguards before any use or sharing</li>
                                    <li>Consider whether synthetic data generation is appropriate for this dataset</li>
                                </ul>
                            </div>
                        </div>

                        <div class="assessment-action">
                            <a href="../assessment-tools.html" class="btn-modern-primary">Access Data Preparation Guide</a>
                        </div>
                    </div>

                    <div class="assessment-card" data-component-theme="portalThemeColorPurple">
                        <h3>Documentation and metadata</h3>
                        <p>Create comprehensive documentation to support synthetic data generation and use:</p>
                        
                        <div class="documentation-requirements">
                            <h4>Required documentation</h4>
                            
                            <div class="doc-item">
                                <h5>Data specification</h5>
                                <p>Detailed description of the prepared source dataset including:</p>
                                <ul>
                                    <li>Complete list of data fields and their definitions</li>
                                    <li>Data types, formats, and coding systems used</li>
                                    <li>Value ranges and validation rules</li>
                                    <li>Relationships between data elements</li>
                                    <li>Any data transformations or preparations applied</li>
                                </ul>
                            </div>

                            <div class="doc-item">
                                <h5>Data quality statement</h5>
                                <p>Assessment of source data quality covering:</p>
                                <ul>
                                    <li><strong>Accuracy:</strong> Methods used to validate data correctness</li>
                                    <li><strong>Completeness:</strong> Levels of missing data and their patterns</li>
                                    <li><strong>Reliability:</strong> Consistency and reproducibility of data collection</li>
                                    <li><strong>Currency:</strong> Data collection timeframes and refresh cycles</li>
                                    <li><strong>Known limitations:</strong> Any quality issues or constraints that may affect synthetic data</li>
                                </ul>
                            </div>

                            <div class="doc-item">
                                <h5>Data dictionary</h5>
                                <p>Comprehensive reference including:</p>
                                <ul>
                                    <li>Field names, descriptions, and business definitions</li>
                                    <li>Permitted values and code lists</li>
                                    <li>Units of measurement and formats</li>
                                    <li>Source systems and collection methods</li>
                                    <li>Data lineage and transformation history</li>
                                </ul>
                            </div>
                        </div>

                        <div class="assessment-action">
                            <a href="../assessment-tools.html" class="btn-modern-primary">Access Documentation Templates</a>
                        </div>
                    </div>
                </div>

                <div class="decision-criteria content-section-card">
                    <h2>Decision criteria for Step 2</h2>
                    <p>To proceed to Step 3, your source data assessment must confirm:</p>
                    
                    <div class="criteria-checklist">
                        <div class="criteria-item">
                            <input type="checkbox" id="criteria1">
                            <label for="criteria1">Your organisation holds and controls the source data</label>
                        </div>
                        <div class="criteria-item">
                            <input type="checkbox" id="criteria2">
                            <label for="criteria2">Source data meets technical quality requirements (accuracy, completeness, consistency, currency)</label>
                        </div>
                        <div class="criteria-item">
                            <input type="checkbox" id="criteria3">
                            <label for="criteria3">Data is fit for purpose for your intended synthetic data use case</label>
                        </div>
                        <div class="criteria-item">
                            <input type="checkbox" id="criteria4">
                            <label for="criteria4">Directly identifying information has been removed or appropriately augmented</label>
                        </div>
                        <div class="criteria-item">
                            <input type="checkbox" id="criteria5">
                            <label for="criteria5">Comprehensive documentation and metadata have been prepared</label>
                        </div>
                        <div class="criteria-item">
                            <input type="checkbox" id="criteria6">
                            <label for="criteria6">No complex scenarios requiring additional assessment have been identified</label>
                        </div>
                    </div>

                    <div class="decision-outcome">
                        <div class="outcome-proceed">
                            <h3>‚úì Proceed to Step 3</h3>
                            <p>Your source data is ready for synthetic data generation. Continue to select and configure appropriate generation models.</p>
                            <a href="step-3-generate-synthetic-data.html" class="btn-modern-primary">Continue to Step 3</a>
                        </div>
                        <div class="outcome-review">
                            <h3>‚Üª Address issues before proceeding</h3>
                            <p>If any criteria are not met, address the following before proceeding:</p>
                            <ul>
                                <li><strong>Data control issues:</strong> Establish appropriate data sharing agreements or access arrangements</li>
                                <li><strong>Quality concerns:</strong> Implement data cleansing or enrichment processes</li>
                                <li><strong>Fitness issues:</strong> Consider alternative data sources or modify use case scope</li>
                                <li><strong>Identification risks:</strong> Apply additional de-identification techniques</li>
                                <li><strong>Documentation gaps:</strong> Complete required metadata and quality statements</li>
                                <li><strong>Complex scenarios:</strong> Follow additional assessment pathways as required</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="technical-considerations content-section-card">
                    <h2>Technical considerations for synthetic data generation</h2>

                    <div class="consideration-grid">
                        <div class="consideration-item">
                            <h3>Data volume and complexity</h3>
                            <ul>
                                <li><strong>Minimum sample size:</strong> Generally >1,000 records for meaningful patterns</li>
                                <li><strong>Optimal sample size:</strong> >10,000 records for complex statistical relationships</li>
                                <li><strong>Variable count:</strong> Consider computational requirements for high-dimensional data</li>
                                <li><strong>Temporal complexity:</strong> Longitudinal data requires specialised generation techniques</li>
                            </ul>
                        </div>

                        <div class="consideration-item">
                            <h3>Data types and structures</h3>
                            <ul>
                                <li><strong>Structured data:</strong> Tabular data with defined schemas work well with most generation methods</li>
                                <li><strong>Mixed data types:</strong> Combinations of numerical, categorical, and text data require careful handling</li>
                                <li><strong>Hierarchical data:</strong> Patient encounters, nested records need specialised approaches</li>
                                <li><strong>Time series data:</strong> Sequential data requires temporal relationship preservation</li>
                            </ul>
                        </div>

                        <div class="consideration-item">
                            <h3>Statistical properties</h3>
                            <ul>
                                <li><strong>Distributions:</strong> Understanding source data distributions guides model selection</li>
                                <li><strong>Correlations:</strong> Important relationships must be preserved in synthetic data</li>
                                <li><strong>Rare events:</strong> Low-frequency outcomes may be poorly represented</li>
                                <li><strong>Outliers:</strong> Extreme values may indicate privacy risks or require special handling</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="related-resources content-section-card">
                    <h2>Related resources for Step 2</h2>

                    <!-- Framework Appendices -->
                    <div class="resource-section">
                        <h3><span class="resource-tag appendix">Appendices</span> Technical guidance</h3>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="resource-card highlight">
                                    <h4>Appendix 6: Technical assessment</h4>
                                    <p>Technical evaluation criteria, quality frameworks, and validation methodologies for source data assessment.</p>
                                    <a href="../resources/appendices/technical-assessment.html" class="btn-modern-primary">View Technical Criteria</a>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="resource-card highlight">
                                    <h4>Appendix 7: De-identification techniques</h4>
                                    <p>Traditional and modern privacy-preserving methods relevant to source data preparation.</p>
                                    <a href="../resources/appendices/deidentification-techniques.html" class="btn-modern-primary">Explore Techniques</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Assessment Tools -->
                    <div class="resource-section">
                        <h3><span class="resource-tag tools">Tools</span> Data evaluation</h3>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="resource-card">
                                    <h4>Quality Metrics Tool</h4>
                                    <p>Comprehensive quality assessment and scoring for source data validation.</p>
                                    <a href="../tools/quality-metrics.html" class="btn-modern-primary">Assess Quality</a>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="resource-card">
                                    <h4>Risk Evaluation Tool</h4>
                                    <p>Systematic risk assessment for data privacy and re-identification concerns.</p>
                                    <a href="../tools/risk-evaluation.html" class="btn-modern-primary">Evaluate Risk</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Next Steps -->
                    <div class="next-steps-section">
                        <h3><span class="resource-tag progression">Next Steps</span> Framework progression</h3>
                        <div class="progression-path">
                            <div class="step-indicator completed">
                                <div class="step-number">1</div>
                                <div class="step-title">Use Case Assessment</div>
                                <div class="step-status">Completed</div>
                            </div>
                            <div class="step-arrow">‚Üí</div>
                            <div class="step-indicator current">
                                <div class="step-number">2</div>
                                <div class="step-title">Assess Source Data</div>
                                <div class="step-status">You are here</div>
                            </div>
                            <div class="step-arrow">‚Üí</div>
                            <div class="step-indicator next">
                                <div class="step-number">3</div>
                                <div class="step-title">Generate Synthetic Data</div>
                                <div class="step-action">
                                    <a href="step-3-generate-synthetic-data.html" class="btn-modern-primary">Continue to Step 3</a>
                                </div>
                            </div>
                        </div>
                        <p class="progression-note">Complete source data assessment before proceeding to synthetic data generation.</p>
                    </div>
                </div>

                <!-- Content Tagging System Component -->
<div class="content-tagging-system" id="content-tagging-system">

  <!-- Page Tags Display -->
  <div class="page-tags-section" id="page-tags">
    <div class="tags-header">
      <span class="tags-icon">üè∑Ô∏è</span>
      <span class="tags-label">Content tags:</span>
    </div>
    <div class="tags-container" id="current-page-tags">
      <!-- Dynamic tags will be inserted here -->
    </div>
  </div>

  <!-- Tag-Based Navigation -->
  <div class="tag-navigation-section" id="tag-navigation" style="display: none;">
    <div class="tag-nav-header">
      <h4 class="tag-nav-title">Explore by tags</h4>
      <button class="toggle-tag-nav" onclick="toggleTagNavigation()">
        <span class="toggle-icon">üîç</span>
        <span class="toggle-text">Browse by tags</span>
      </button>
    </div>

    <!-- Tag Categories -->
    <div class="tag-categories" id="tag-categories">

      <!-- Framework Tags -->
      <div class="tag-category framework-tags">
        <h5 class="category-title">
          <span class="category-icon">üìã</span>
          Framework process
        </h5>
        <div class="category-tags" id="framework-tag-list">
          <!-- Dynamic content -->
        </div>
      </div>

      <!-- Content Type Tags -->
      <div class="tag-category content-tags">
        <h5 class="category-title">
          <span class="category-icon">üìÑ</span>
          Content types
        </h5>
        <div class="category-tags" id="content-tag-list">
          <!-- Dynamic content -->
        </div>
      </div>

      <!-- Topic Tags -->
      <div class="tag-category topic-tags">
        <h5 class="category-title">
          <span class="category-icon">üéØ</span>
          Topics
        </h5>
        <div class="category-tags" id="topic-tag-list">
          <!-- Dynamic content -->
        </div>
      </div>

      <!-- Complexity Tags -->
      <div class="tag-category complexity-tags">
        <h5 class="category-title">
          <span class="category-icon">üìä</span>
          Complexity level
        </h5>
        <div class="category-tags" id="complexity-tag-list">
          <!-- Dynamic content -->
        </div>
      </div>

    </div>

    <!-- Tagged Content Results -->
    <div class="tagged-content-results" id="tagged-content-results" style="display: none;">
      <div class="results-header">
        <h5 class="results-title">Related content</h5>
        <button class="clear-filter" onclick="clearTagFilter()">Clear filter</button>
      </div>
      <div class="results-grid" id="results-grid">
        <!-- Dynamic content -->
      </div>
    </div>

  </div>

</div>

<!-- Cross-Reference Navigation Component -->
<nav class="cross-reference-nav" aria-label="Cross-reference navigation">
  <div class="cross-ref-container">

    <!-- Related Appendices Section -->
    <div class="cross-ref-section appendices-section" id="related-appendices">
      <div class="section-header">
        <span class="section-icon">üìö</span>
        <h4 class="section-title">Related appendices</h4>
      </div>
      <div class="cross-ref-items" id="appendices-list">
        <!-- Dynamic content will be inserted here -->
      </div>
    </div>

    <!-- Assessment Tools Section -->
    <div class="cross-ref-section tools-section" id="related-tools">
      <div class="section-header">
        <span class="section-icon">üõ†Ô∏è</span>
        <h4 class="section-title">Recommended tools</h4>
      </div>
      <div class="cross-ref-items" id="tools-list">
        <!-- Dynamic content will be inserted here -->
      </div>
    </div>

    <!-- Next Steps Section -->
    <div class="cross-ref-section next-steps-section" id="next-steps">
      <div class="section-header">
        <span class="section-icon">‚û°Ô∏è</span>
        <h4 class="section-title">Next steps</h4>
      </div>
      <div class="cross-ref-items" id="next-steps-list">
        <!-- Dynamic content will be inserted here -->
      </div>
    </div>

    <!-- Related Pages Section -->
    <div class="cross-ref-section related-pages-section" id="related-pages">
      <div class="section-header">
        <span class="section-icon">üîó</span>
        <h4 class="section-title">Related pages</h4>
      </div>
      <div class="cross-ref-items" id="related-pages-list">
        <!-- Dynamic content will be inserted here -->
      </div>
    </div>

  </div>
</nav>

<!-- Related Resources Section Component -->
<section class="related-resources-section" aria-label="Related resources">
  <div class="related-resources-container">

    <div class="section-header">
      <h3 class="section-title">
        <span class="title-icon">üìö</span>
        Related resources
      </h3>
      <p class="section-description">Discover additional resources relevant to this content</p>
    </div>

    <!-- Quick Access Resources -->
    <div class="resource-category quick-access" id="quick-access-resources">
      <div class="category-header">
        <span class="category-icon">‚ö°</span>
        <h4 class="category-title">Quick access</h4>
      </div>
      <div class="resource-grid" id="quick-access-grid">
        <!-- Dynamic content -->
      </div>
    </div>

    <!-- Documentation Resources -->
    <div class="resource-category documentation" id="documentation-resources">
      <div class="category-header">
        <span class="category-icon">üìÑ</span>
        <h4 class="category-title">Documentation</h4>
      </div>
      <div class="resource-grid" id="documentation-grid">
        <!-- Dynamic content -->
      </div>
    </div>

    <!-- Assessment Resources -->
    <div class="resource-category assessment" id="assessment-resources">
      <div class="category-header">
        <span class="category-icon">üìã</span>
        <h4 class="category-title">Assessment tools</h4>
      </div>
      <div class="resource-grid" id="assessment-grid">
        <!-- Dynamic content -->
      </div>
    </div>

    <!-- Legal & Compliance Resources -->
    <div class="resource-category legal" id="legal-resources">
      <div class="category-header">
        <span class="category-icon">‚öñÔ∏è</span>
        <h4 class="category-title">Legal & compliance</h4>
      </div>
      <div class="resource-grid" id="legal-grid">
        <!-- Dynamic content -->
      </div>
    </div>

    <!-- Technical Resources -->
    <div class="resource-category technical" id="technical-resources">
      <div class="category-header">
        <span class="category-icon">üîß</span>
        <h4 class="category-title">Technical guidance</h4>
      </div>
      <div class="resource-grid" id="technical-grid">
        <!-- Dynamic content -->
      </div>
    </div>

    <!-- View All Resources Link -->
    <div class="view-all-section">
      <a href="/web-pages/../resources.html" class="view-all-link">
        <span class="link-icon">üóÇÔ∏è</span>
        <span class="link-text">View all resources</span>
        <span class="link-arrow">‚Üí</span>
      </a>
    </div>

  </div>
</section>

                <div class="common-scenarios">
                    <h2>Common scenarios and guidance</h2>

                    <div class="scenario-accordion">
                        <div class="scenario-item">
                            <button class="scenario-header" data-toggle="collapse" data-target="#scenario1">
                                <h3>Data availability issues</h3>
                                <span class="toggle-icon">+</span>
                            </button>
                            <div id="scenario1" class="scenario-content collapse">
                                <p><strong>Situation:</strong> Your organisation doesn't directly control all required source data, or data is held across multiple systems.</p>
                                <p><strong>Guidance:</strong></p>
                                <ul>
                                    <li>Establish formal data sharing agreements before proceeding</li>
                                    <li>Consider using the Complex Scenarios Navigator for multi-party data access</li>
                                    <li>Document data custodianship and access arrangements</li>
                                    <li>Assess whether data linkage is required and appropriate</li>
                                </ul>
                                <p><strong>Related tool:</strong> <a href="../decision-support/complex-scenarios.html">Complex Scenarios Navigator</a></p>
                            </div>
                        </div>

                        <div class="scenario-item">
                            <button class="scenario-header" data-toggle="collapse" data-target="#scenario2">
                                <h3>Third-party data processors</h3>
                                <span class="toggle-icon">+</span>
                            </button>
                            <div id="scenario2" class="scenario-content collapse">
                                <p><strong>Situation:</strong> Synthetic data generation will be performed by external vendors or cloud service providers.</p>
                                <p><strong>Guidance:</strong></p>
                                <ul>
                                    <li>Ensure data processing agreements are in place before sharing source data</li>
                                    <li>Specify security and privacy requirements for data handling</li>
                                    <li>Consider data sovereignty and jurisdiction issues for cloud processing</li>
                                    <li>Document the role and responsibilities of all data processors</li>
                                </ul>
                                <p><strong>Related resource:</strong> <a href="../resources/appendices/lawful-pathways.html">Appendix 9: Lawful Pathways</a></p>
                            </div>
                        </div>

                        <div class="scenario-item">
                            <button class="scenario-header" data-toggle="collapse" data-target="#scenario3">
                                <h3>Cross-organisational data sharing</h3>
                                <span class="toggle-icon">+</span>
                            </button>
                            <div id="scenario3" class="scenario-content collapse">
                                <p><strong>Situation:</strong> Source data needs to be combined from multiple health organisations or jurisdictions.</p>
                                <p><strong>Guidance:</strong></p>
                                <ul>
                                    <li>Use the Legal Pathways Wizard to determine appropriate legal basis</li>
                                    <li>Establish data sharing governance with all participating organisations</li>
                                    <li>Consider using privacy-preserving data linkage techniques</li>
                                    <li>Document cross-jurisdictional privacy requirements</li>
                                </ul>
                                <p><strong>Related tool:</strong> <a href="../decision-support/legal-pathways-wizard.html">Legal Pathways Wizard</a></p>
                            </div>
                        </div>

                        <div class="scenario-item">
                            <button class="scenario-header" data-toggle="collapse" data-target="#scenario4">
                                <h3>Data quality problems</h3>
                                <span class="toggle-icon">+</span>
                            </button>
                            <div id="scenario4" class="scenario-content collapse">
                                <p><strong>Situation:</strong> Source data has significant quality issues including missing values, inconsistent coding, or accuracy concerns.</p>
                                <p><strong>Guidance:</strong></p>
                                <ul>
                                    <li>Use the Quality Metrics Tool to systematically assess data quality</li>
                                    <li>Consider whether data cleansing is feasible and appropriate</li>
                                    <li>Document known quality limitations and their impact on synthetic data</li>
                                    <li>Assess whether quality issues prevent synthetic data generation</li>
                                </ul>
                                <p><strong>Related tool:</strong> <a href="../tools/quality-metrics.html">Quality Metrics Tool</a></p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="step-navigation">
                    <div class="nav-buttons">
                        <a href="step-1-use-case-assessment.html" class="nav-button nav-previous">‚Üê Step 1: Use Case Assessment</a>
                        <a href="step-3-generate-synthetic-data.html" class="nav-button nav-next">Step 3: Generate Synthetic Data ‚Üí</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
// Content Tagging System JavaScript
document.addEventListener('DOMContentLoaded', function() {
    const currentPath = window.location.pathname;

    // Comprehensive tag database for all content
    const contentTags = {
        // Page-specific tags
        pages: {
            '/step-2-assess-source-data': {
                primary: ['step-2', 'source-data', 'assessment'],
                secondary: ['data-quality', 'technical-assessment', 'preparation'],
                framework: ['step-2'],
                contentType: ['step-guide', 'assessment', 'technical'],
                topics: ['source-data', 'data-quality', 'preparation', 'metadata'],
                complexity: ['intermediate']
            }
        }
    };

    // Tag category definitions
    const tagCategories = {
        framework: {
            'step-2': 'Step 2: Assess Source Data',
            'step-3': 'Step 3: Generate Synthetic Data',
            'step-4': 'Step 4: Assess Re-identification Risks'
        },
        contentType: {
            'step-guide': 'Step-by-Step Guide',
            'assessment': 'Assessment',
            'technical': 'Technical Guide',
            'documentation': 'Documentation'
        },
        topics: {
            'source-data': 'Source Data',
            'data-quality': 'Data Quality',
            'preparation': 'Data Preparation',
            'metadata': 'Metadata & Documentation'
        },
        complexity: {
            'intermediate': 'Intermediate',
            'advanced': 'Advanced'
        }
    };

    function initializeTaggingSystem() {
        displayCurrentPageTags();
        initializeTagCategories();
    }

    function displayCurrentPageTags() {
        const pageTagsContainer = document.getElementById('current-page-tags');
        const pageTags = getCurrentPageTags();

        if (pageTags.length === 0) {
            document.getElementById('page-tags').style.display = 'none';
            return;
        }

        pageTagsContainer.innerHTML = '';
        pageTags.forEach(tag => {
            const tagElement = createTagElement(tag, 'current-page');
            pageTagsContainer.appendChild(tagElement);
        });
    }

    function getCurrentPageTags() {
        const pageConfig = contentTags.pages[currentPath] || contentTags.pages['/step-2-assess-source-data'];
        if (!pageConfig) return [];

        return [...(pageConfig.primary || []), ...(pageConfig.secondary || [])];
    }

    function initializeTagCategories() {
        populateTagCategory('framework-tag-list', tagCategories.framework);
        populateTagCategory('content-tag-list', tagCategories.contentType);
        populateTagCategory('topic-tag-list', tagCategories.topics);
        populateTagCategory('complexity-tag-list', tagCategories.complexity);
    }

    function populateTagCategory(containerId, categoryTags) {
        const container = document.getElementById(containerId);
        if (!container) return;

        container.innerHTML = '';
        Object.keys(categoryTags).forEach(tagKey => {
            const tagElement = createTagElement(tagKey, 'filter', categoryTags[tagKey]);
            container.appendChild(tagElement);
        });
    }

    function createTagElement(tag, type, displayName = null) {
        const tagElement = document.createElement('span');
        tagElement.className = `content-tag ${type}-tag`;
        tagElement.textContent = displayName || formatTagName(tag);
        tagElement.setAttribute('data-tag', tag);

        if (type === 'filter') {
            tagElement.onclick = () => filterByTag(tag);
            tagElement.style.cursor = 'pointer';
        }

        return tagElement;
    }

    function formatTagName(tag) {
        return tag.split('-').map(word =>
            word.charAt(0).toUpperCase() + word.slice(1)
        ).join(' ');
    }

    function filterByTag(tag) {
        alert(`Filtering by tag: ${formatTagName(tag)}`);
    }

    // Global functions for button handlers
    window.toggleTagNavigation = function() {
        const tagNav = document.getElementById('tag-navigation');
        const isVisible = tagNav.style.display !== 'none';

        if (isVisible) {
            tagNav.style.display = 'none';
        } else {
            tagNav.style.display = 'block';
        }
    };

    window.clearTagFilter = function() {
        document.getElementById('tagged-content-results').style.display = 'none';
    };

    // Initialize on page load
    initializeTaggingSystem();
});

// Cross-Reference Navigation JavaScript
document.addEventListener('DOMContentLoaded', function() {
    const currentPath = window.location.pathname;

    // Cross-reference mapping for Step 2
    const crossReferences = {
        '/step-2-assess-source-data': {
            appendices: [
                { id: 6, title: 'Technical assessment', url: '/web-pages/../resources/appendices/technical-assessment.html', description: 'Technical evaluation criteria and quality frameworks' },
                { id: 7, title: 'De-identification techniques', url: '/web-pages/../resources/appendices/deidentification-techniques.html', description: 'Traditional and modern privacy-preserving methods' }
            ],
            tools: [
                { title: 'Quality Metrics Tool', url: '/web-pages/../tools/quality-metrics.html', description: 'Comprehensive quality assessment and scoring' },
                { title: 'Risk Evaluation Tool', url: '/web-pages/../tools/risk-evaluation.html', description: 'Systematic privacy risk assessment' },
                { title: 'Complex Scenarios Navigator', url: '/web-pages/../decision-support/complex-scenarios.html', description: 'Guidance for complex data sharing scenarios' }
            ],
            nextSteps: [
                { title: 'Step 3: Generate Synthetic Data', url: '/web-pages/step-3-generate-synthetic-data.html', description: 'Select and configure generation models' }
            ],
            relatedPages: [
                { title: 'Framework Overview', url: '/web-pages/../framework.html', description: 'Return to framework overview' }
            ]
        }
    };

    // Initialize cross-references for current page
    function initializeCrossReferences() {
        const pageRefs = crossReferences[currentPath] || crossReferences['/step-2-assess-source-data'];

        populateSection('appendices-list', pageRefs.appendices || [], 'appendix');
        populateSection('tools-list', pageRefs.tools || [], 'tool');
        populateSection('next-steps-list', pageRefs.nextSteps || [], 'next-step');
        populateSection('related-pages-list', pageRefs.relatedPages || [], 'page');

        hideEmptySections();
    }

    function populateSection(containerId, items, itemType) {
        const container = document.getElementById(containerId);
        if (!container) return;

        if (items.length === 0) {
            container.parentElement.style.display = 'none';
            return;
        }

        container.innerHTML = '';

        items.forEach(item => {
            const itemElement = createCrossRefItem(item, itemType);
            container.appendChild(itemElement);
        });
    }

    function createCrossRefItem(item, itemType) {
        const div = document.createElement('div');
        div.className = `cross-ref-item ${itemType}-item`;

        const link = document.createElement('a');
        link.href = item.url;
        link.className = 'cross-ref-link';

        const icon = document.createElement('span');
        icon.className = 'item-icon';
        icon.textContent = getItemIcon(itemType, item);

        const content = document.createElement('div');
        content.className = 'item-content';

        const title = document.createElement('span');
        title.className = 'item-title';
        title.textContent = item.title;

        const description = document.createElement('span');
        description.className = 'item-description';
        description.textContent = item.description;

        content.appendChild(title);
        content.appendChild(description);

        link.appendChild(icon);
        link.appendChild(content);
        div.appendChild(link);

        return div;
    }

    function getItemIcon(itemType, item) {
        switch (itemType) {
            case 'appendix':
                return item.id ? item.id.toString() : 'üìÑ';
            case 'tool':
                return 'üõ†Ô∏è';
            case 'next-step':
                return '‚û°Ô∏è';
            case 'page':
                return 'üîó';
            default:
                return 'üìÑ';
        }
    }

    function hideEmptySections() {
        const sections = document.querySelectorAll('.cross-ref-section');
        sections.forEach(section => {
            const items = section.querySelector('.cross-ref-items');
            if (!items || items.children.length === 0) {
                section.style.display = 'none';
            }
        });
    }

    // Initialize on page load
    initializeCrossReferences();
});

// Related Resources JavaScript
document.addEventListener('DOMContentLoaded', function() {
    const currentPath = window.location.pathname;

    // Resource database for Step 2
    const resourceDatabase = {
        quickAccess: [
            {
                title: 'Framework overview',
                url: '/web-pages/../framework.html',
                description: 'Complete framework process guide',
                tags: ['framework', 'overview', 'process']
            },
            {
                title: 'Assessment tools overview',
                url: '/web-pages/../assessment-tools.html',
                description: 'Interactive assessment tools',
                tags: ['assessment', 'tools', 'interactive']
            }
        ],
        documentation: [
            {
                title: 'Technical assessment criteria',
                url: '/web-pages/../resources/appendices/technical-assessment.html',
                description: 'Detailed technical evaluation methodology',
                tags: ['technical', 'assessment', 'criteria']
            },
            {
                title: 'De-identification techniques guide',
                url: '/web-pages/../resources/appendices/deidentification-techniques.html',
                description: 'Privacy-preserving methods for data preparation',
                tags: ['deidentification', 'privacy', 'techniques']
            }
        ],
        assessment: [
            {
                title: 'Quality metrics tool',
                url: '/web-pages/../tools/quality-metrics.html',
                description: 'Comprehensive data quality assessment',
                tags: ['tool', 'quality', 'assessment']
            },
            {
                title: 'Risk evaluation tool',
                url: '/web-pages/../tools/risk-evaluation.html',
                description: 'Privacy and re-identification risk assessment',
                tags: ['tool', 'risk', 'privacy']
            }
        ],
        technical: [
            {
                title: 'Data specification templates',
                url: '/web-pages/../resources/appendices/technical-assessment.html',
                description: 'Templates for documenting source data',
                tags: ['templates', 'documentation', 'technical']
            }
        ]
    };

    function initializeRelatedResources() {
        populateResourceCategory('quick-access-grid', resourceDatabase.quickAccess, 3);
        populateResourceCategory('documentation-grid', resourceDatabase.documentation, 4);
        populateResourceCategory('assessment-grid', resourceDatabase.assessment, 3);
        populateResourceCategory('legal-grid', [], 0);
        populateResourceCategory('technical-grid', resourceDatabase.technical, 3);

        hideEmptyCategories();
    }

    function populateResourceCategory(gridId, resources, maxItems) {
        const grid = document.getElementById(gridId);
        if (!grid) return;

        if (resources.length === 0) {
            grid.parentElement.style.display = 'none';
            return;
        }

        grid.innerHTML = '';
        resources.slice(0, maxItems).forEach(resource => {
            const resourceElement = createResourceCard(resource);
            grid.appendChild(resourceElement);
        });
    }

    function createResourceCard(resource) {
        const card = document.createElement('div');
        card.className = 'resource-card';

        card.innerHTML = `
            <a href="${resource.url}" class="resource-link">
                <div class="resource-content">
                    <h5 class="resource-title">${resource.title}</h5>
                    <p class="resource-description">${resource.description}</p>
                    <div class="resource-tags">
                        ${resource.tags.slice(0, 3).map(tag =>
                            `<span class="resource-tag">${tag}</span>`
                        ).join('')}
                    </div>
                </div>
                <div class="resource-arrow">‚Üí</div>
            </a>
        `;

        return card;
    }

    function hideEmptyCategories() {
        const categories = document.querySelectorAll('.resource-category');
        categories.forEach(category => {
            const grid = category.querySelector('.resource-grid');
            if (!grid || grid.children.length === 0) {
                category.style.display = 'none';
            }
        });
    }

    // Initialize on page load
    initializeRelatedResources();
});
</script>

    <script>
        // Accordion functionality for scenarios
        document.addEventListener('DOMContentLoaded', function() {
            const scenarioHeaders = document.querySelectorAll('.scenario-header');

            scenarioHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    const target = this.getAttribute('data-target');
                    const content = document.querySelector(target);
                    const icon = this.querySelector('.toggle-icon');

                    if (content.classList.contains('show')) {
                        content.classList.remove('show');
                        icon.textContent = '+';
                    } else {
                        // Close all other scenarios
                        document.querySelectorAll('.scenario-content').forEach(sc => {
                            sc.classList.remove('show');
                        });
                        document.querySelectorAll('.toggle-icon').forEach(ti => {
                            ti.textContent = '+';
                        });

                        // Open clicked scenario
                        content.classList.add('show');
                        icon.textContent = '‚àí';
                    }
                });
            });
        });
    </script>

    <!-- Back to Top Button -->
    <button onclick="scrollToTop()" id="backToTop" style="display: none; position: fixed; bottom: 20px; right: 20px; z-index: 99; background: #F7C59F; color: white; border: none; padding: 15px 18px; border-radius: 50%; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.2); font-size: 1.2rem; font-weight: bold;">‚Üë</button>

    <script>
    // Back to Top functionality
    window.onscroll = function() {
        const backToTop = document.getElementById('backToTop');
        if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            backToTop.style.display = "block";
        } else {
            backToTop.style.display = "none";
        }
    };

    function scrollToTop() {
        window.scrollTo({top: 0, behavior: 'smooth'});
    }
    </script>

    <!-- OpenAI ChatKit Chatbot -->
    <link rel="stylesheet" href="../assets/chatbot/chatbot.css">
    <script src="https://cdn.platform.openai.com/deployments/chatkit/chatkit.js" async></script>
    <script src="../assets/chatbot/sloth-avatar.js"></script>
    <script src="../assets/chatbot/chatbot.js"></script>
</body>
</html>
